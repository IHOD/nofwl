
/**
 * Add back the container background-color, border-radius, padding, margin
 * and overflow that we removed from <pre>.
 */
.gatsby-highlight {
  overflow: auto;
  // border-radius: 0.3em;
  margin: 0.5em 0;
  box-shadow: var(--code-box-shadow);

  /**
  * Remove the default PrismJS theme background-color, border-radius, margin,
  * padding and overflow.
  * 1. Make the element just wide enough to fit its content.
  * 2. Always fill the visible space in .gatsby-highlight.
  * 3. Adjust the position of the line numbers
  */
  pre[class*="language-"] {
    background-color: transparent;
    margin: 0;
    padding: 0;
    overflow: initial;
    float: left; /* 1 */
    min-width: 100%; /* 2 */
  }

  .line-numbers {
    .line-numbers-rows {
      top: 5px;
    }
  }
}

// code style
.gatsby-highlight {
  position: relative;
  background: var(--code-bg);
  -webkit-overflow-scrolling: touch;
  color: var(--code-def-txet);
  pre[class*="language-"] {
    background-color: transparent;
    border: 0;
    -webkit-overflow-scrolling: touch;
    &::before {
      position: absolute;
      text-align: right;
    }
  }

  pre {
    code {
      display: block;
      font-size: 100%;
      float: left;
      min-width: 100%;
    }
    // ::-webkit-scrollbar { }
    ::-webkit-scrollbar-thumb {
      background: var(--code-scrollbar-thumb);
    }
    ::-webkit-scrollbar-track {
      background: var(--code-border);
    }
  }

  [class*='language-'] {
    padding-left: 26px;
  }
  .language-symbol {
    text-align: center;
    // text-shadow: 1px 1px 1px #000;
    .line-numbers-rows {
      display: none !important;
    }
  }
}

.gatsby-highlight-code-line {
  display: block;
  // TODO:
  background: var(--common-bg);
  border-left: solid 3px var(--ui-red);
  text-indent: 7px;
  margin-left: -9px;
}

.gatsby-resp-image-link {
  overflow: hidden;
  img {
    box-shadow: none !important;
  }
}
.gatsby-resp-image-link,
.gatsby-resp-image-wrapper {
  + em {
    position: relative;
    display: block;
    font-style: normal;
    a {
      font-weight: normal;
      color: var(--common-lilac);
    }
  }
}

.gatsby-code-title {
  background: var(--code-bg);
  border-bottom: solid 1px var(--code-border);
  color: var(--code-text);
  font-size: 74%;
}

.main-body {
  a {
    color: var(--common-lilac);
    text-decoration: none;
    border-bottom: solid 1px var(--common-lilac);
    &:hover {
      border-bottom-color: var(--ui-bright);
    }
    &.anchor {
      color: inherit;
      fill: var(--common-lilac);
      text-decoration: none;
      border-bottom: none;
      &:hover {
        background: none;
      }
    }
    &.gatsby-resp-image-link {
      border-bottom: transparent;
      &::after {
        display: none;
      }
    }
  }
  figure {
    a {
      .gatsby-resp-image-link {
        border-bottom: transparent;
        margin-bottom: 0;
      }
    }
  }
}

.nofwl-container {
  a.gatsby-resp-image-link {
    border-bottom: transparent;
    &::after {
      display: none;
    }
  }
}

.post-body {
  figure img {
    margin-bottom: 0;
  }
  figcaption {
    font-size: 87.5%;
  }
}

// PrismJS syntax highlighting token styles
// https://www.gatsbyjs.org/packages/gatsby-remark-prismjs/
.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: var(--code-comment);
}

.token.function {
  color: var(--code-function);
}

.token.parameter {
  color: var(--code-parameter);
}

.token.punctuation {
  color: var(--code-punctuation);
}

.token.tag,
.token.property,
.token.boolean,
.token.number,
.token.function-name,
.token.constant,
.token.symbol {
  color: var(--code-tag);
}

.token.string,
.token.char {
  color: var(--code-string);
}

.token.selector,
.token.attr-name,
.token.builtin {
  color: var(--code-selector);
}

.token.operator,
.token.entity,
.token.url,
.token.variable {
  color: var(--code-operator);
}

.token.keyword,
.token.atrule,
.token.attr-value,
.token.class-name {
  color: var(--code-keyword);
  font-weight: bold;
}

.token.inserted {
  color: var(--code-add);
}

.token.deleted {
  color: var(--code-remove);
}

.token.regex,
.token.important {
  color: var(--code-regex);
}

.language-css .token.string,
.style .token.string {
  color: var(--code-css-string);
}

.token.important {
  font-weight: normal;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}

.token.entity {
  cursor: help;
}

.namespace {
  opacity: 0.7;
}

// PrismJS plugin styles
.token.tab:not(:empty):before,
.token.cr:before,
.token.lf:before {
  color: var(--code-invisibles);
}

// Fancy external links in posts, borrowed from
// https://github.com/comfusion/after-dark/
// @see https://github.com/comfusion/after-dark/blob/8fdbe2f480ac40315cf0e01cece785d2b5c4b0c3/layouts/partials/critical-theme.css#L36-L39
.gatsby-resp-image-link + em a[href*='//']:after {
  content: " " url("data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20class='i-external'%20viewBox='0%200%2032%2032'%20width='14'%20height='14'%20fill='none'%20stroke='%23744C9E'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='9.38%'%3E%3Cpath%20d='M14%209%20L3%209%203%2029%2023%2029%2023%2018%20M18%204%20L28%204%2028%2014%20M28%204%20L14%2018'/%3E%3C/svg%3E");
}